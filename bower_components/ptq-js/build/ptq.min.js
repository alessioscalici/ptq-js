window.ptq=function(){"use strict";var t=function(t){this.symbol=t,this.ignore=!1,this.pushback=!1,this.gotoTarget=null,this.start=null,this.end=!1,this.indent=!1},e=function(t){this.is=new a(t)};e.prototype.assertConst=function(t){var e=this.readHTF8();if(e!==t)throw"Error reading stream (expected "+t+", read "+e+")"},e.prototype.readHTF8=function(){if(!this.is.hasNext())throw"Deserializer: stream is finished";var t=this.is.read();if(0===(128&t))return t;if(0===(64&t))throw"Deserializer: unexpected continuation byte";for(var e=0,i=32,s=31,n=1;6>n;++n){if(e=e<<6|63&this.is.read(),0===(t&i))return e|(t&s)<<6*n;i>>>=1,s>>>=1}throw"Illegal start byte: "+t.toString(16)},e.prototype.readString=function(){for(var t=this.readHTF8(),e="",i=0;t>i;++i)e+=String.fromCharCode(this.is.read());return e},e.prototype.readHeader=function(){if(80!==this.is.read()||84!==this.is.read()||81!==this.is.read()||30!==this.is.read())throw"Deserializer: Illegal header"},e.prototype.readInfoSection=function(){if(this.assertConst(f.BEGIN_INFO_SECTION),this.name=this.readString(),this.assertConst(f.BYTE_RECORD_SEPARATOR),this.iRequiredMajorVersion=this.readHTF8(),this.iRequiredMinorVersion=this.readHTF8(),this.iRequiredPatchVersion=this.readHTF8(),this.iRequiredMajorVersion>T.MAJOR_VERSION||this.iRequiredMajorVersion===T.MAJOR_VERSION&&this.iRequiredMinorVersion>T.MINOR_VERSION||this.iRequiredMajorVersion===T.MAJOR_VERSION&&this.iRequiredMinorVersion===T.MINOR_VERSION&&this.iRequiredPatchVersion>T.PATCH_VERSION)throw"Version required: "+this.iRequiredMajorVersion+"."+this.iRequiredMinorVersion+"."+this.iRequiredPatchVersion;this.assertConst(f.BYTE_RECORD_SEPARATOR)},e.prototype.readScannerSection=function(){this.assertConst(f.BEGIN_SCANNER_SECTION),this.readCharacterSetSection(),this.readTerminalSection(),this.readDfaSection(),this.assertConst(f.BYTE_RECORD_SEPARATOR);var t=new E(this.dfas,this.dfas[0].name,this.symbols);return t.indentBased=this.containsIndentFlag,t.init(this.dfas,this.dfas[0].name,this.symbols),t.firstIgnoredIndex=this.publicSymbolTableLength,t},e.prototype.readCharacterSetSection=function(){this.assertConst(f.BEGIN_CHARACTER_SET_SECTION);var t=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR),this.characterSets=[];for(var e=0;t>e;++e){var i=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);for(var s=[],n=0;i>n;++n)for(var r=this.readHTF8(),o=this.readHTF8(),a=r;o>=a;++a){if(0>a||a>1114111||a>=55296&&57343>=a)throw"Error reading Character Set section: invalid Unicode code point 0x"+a.toString(16);s.push(a)}this.characterSets.push(s)}},e.prototype.readTerminalSection=function(){this.assertConst(f.BEGIN_TERMINAL_SECTION);var t=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR),this.publicSymbolTableLength=this.readHTF8(),this.assertConst(f.BYTE_UNIT_SEPARATOR),this.symbols=[];for(var e=0;t>e;++e){var i=new N(this.readString(),e),s=this.readString();s.length&&i.setDisplayName(s),this.symbols.push(i)}},e.prototype.readDfaSection=function(){this.assertConst(f.BEGIN_DFA_SECTION);var t,e=this.readHTF8();for(this.assertConst(f.BYTE_UNIT_SEPARATOR),this.dfas=[],this.targetActionList=[],t=0;e>t;++t)this.dfas.push(this.readSingleDfa());for(t=0;t<this.targetActionList.length;++t){var i=this.targetActionList[t],s=i[1],n=this.dfas[i[0]],r=this.dfas[i[3]],o=this.symbols[i[2]];s===f.DFA_ACTION_BEGIN?n.upsertAction(o).start=r:s===f.DFA_ACTION_GOTO&&(n.upsertAction(o).gotoTarget=r)}},e.prototype.readSingleDfa=function(){this.assertConst(f.BEGIN_SINGLE_DFA);var e,s=this.readString();this.assertConst(f.BEGIN_DFA_STATE_SECTION);var n=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var r=[];for(e=0;n>e;++e)r.push(new g);var o=this.readHTF8();for(this.assertConst(f.BYTE_UNIT_SEPARATOR),e=0;o>e;++e){var a=this.readHTF8(),h=this.readHTF8();r[a].acceptedSymbol=this.symbols[h]}this.assertConst(f.BEGIN_DFA_EDGE_SECTION);var c=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var u=[];for(e=0;n>e;++e)u.push([]);for(e=0;c>e;++e){var l=this.readHTF8(),d=this.readHTF8(),p=this.readHTF8();u[l].push(new i(r[l],r[d],this.characterSets[p]))}for(e=0;n>e;++e)r[e].edges=u[e];this.assertConst(f.BEGIN_DFA_ACTION_SECTION);var T=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var S=null,E={},R=!1;for(e=0;T>e;++e){var I,N=this.readHTF8(),y=this.readHTF8();switch(E[y]?S=E[y]:(S=new t(this.symbols[y]),E[y]=S),N){case f.DFA_ACTION_IGNORE:S.ignore=!0;break;case f.DFA_ACTION_PUSHBACK:S.pushback=!0;break;case f.DFA_ACTION_END:S.end=!0;break;case f.DFA_ACTION_INDENT:S.indent=!0,R=!0,this.containsIndentFlag=!0;break;case f.DFA_ACTION_BEGIN:case f.DFA_ACTION_GOTO:I=this.readHTF8();var A=[];A.push(this.dfas.length),A.push(N),A.push(y),A.push(I),this.targetActionList.push(A)}}var O=new _(s,r[0]);O.indentBased=R;for(var C in E)E.hasOwnProperty(C)&&O.setAction(E[C]);return O},e.prototype.readParserSection=function(){this.assertConst(f.BEGIN_PARSER_SECTION),this.parserType=this.readHTF8(),this.assertConst(f.BYTE_RECORD_SEPARATOR);var t=this.readSymbolTableSection(),e=this.readHTF8();this.assertConst(f.BYTE_RECORD_SEPARATOR);var i=this.readRuleTableSection(t);switch(this.parserType){case f.PARSER_TYPE_LR0:case f.PARSER_TYPE_SLR:case f.PARSER_TYPE_LR1:case f.PARSER_TYPE_LALR1:case f.PARSER_TYPE_LRED1:var s=this.readLR1TableSection();return new d(s,i,t,e,this.scanner);default:throw"Unknown parser type"}},e.prototype.readSymbolTableSection=function(){this.assertConst(f.BEGIN_SYMBOL_SECTION);var t=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var e,i=this.readHTF8(),s=this.scanner.getPublicSymbolTable(),n=[];for(e=0;i>e;++e)n.push(s[e]);for(e=i;t>e;++e)n.push(new l(this.readString(),e));return this.assertConst(f.BYTE_RECORD_SEPARATOR),n},e.prototype.readRuleTableSection=function(t){this.assertConst(f.BEGIN_RULE_SECTION);var e=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);for(var i=[],s=0;e>s;++s){var n=this.readHTF8(),r=[],a=this.readHTF8();if(a>=t.length)throw"The stream contains corrupt data (index out of bounds)";if(!(t[a]instanceof l))throw"The stream contains corrupt data (head of rule is terminal)";for(var h=1;n>h;++h){var c=this.readHTF8();if(c>=t.length)throw"The stream contains corrupt data (index out of bounds)";r.push(t[c])}i.push(new o(s,t[a],r))}return this.assertConst(f.BYTE_RECORD_SEPARATOR),i},e.prototype.readLR1TableSection=function(){this.assertConst(f.BEGIN_TABLE_SECTION);var t=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var e=this.readHTF8();this.assertConst(f.BYTE_UNIT_SEPARATOR);var i,s=[];for(i=0;t>i;++i)s.push([]);for(i=0;e>i;++i){var n=this.readHTF8(),r=this.readHTF8(),o=c.get(this.readHTF8());switch(o.code){case c.NONE.code:break;case c.ACCEPT.code:s[n][r]=new h(o);break;case c.SHIFT.code:case c.GOTO.code:case c.REDUCE.code:var a=this.readHTF8();s[n][r]=new h(o,a);break;default:throw"Error reading LR1 section: undefined LRAction"}}return this.assertConst(f.BYTE_RECORD_SEPARATOR),s},e.prototype.deserialize=function(){return this.readHeader(),this.readInfoSection(),this.scanner=this.readScannerSection(),this.scanner.name=this.name,this.is.hasNext()?this.readParserSection():this.scanner};var i=function(t,e,i){this.sourceState=t,this.targetState=e,i&&(this.ranges=this.getRanges(i))};i.prototype.getRanges=function(t){if(!t||!t.length)return[];for(var e,i=[],s=t.slice(),n=s[0],r=s[0],o=1;o<s.length;++o)s[o]!==r+1?(e=[],e.push(n),e.push(r),i.push(e),n=s[o],r=s[o]):r=s[o];return e=[],e.push(n),e.push(r),i.push(e),i},i.prototype.accepts=function(t){for(var e=0,i=this.ranges.length-1;i>=e;){var s=e+i>>>1;if(this.ranges[s][1]<t)e=s+1;else{if(!(this.ranges[s][0]>t))return!0;i=s-1}}return!1};var s=function(t,e,i){this.type=t,this.lastToken=e,this.expectedSymbols=i};s.prototype.toString=function(){var t=this.type?this.type.toString():"null";if(this.lastToken&&this.lastToken.pos&&(t+=" ("+this.lastToken.pos.line+", "+this.lastToken.pos.col+")"),this.expectedSymbols){t+=" ->";for(var e in this.expectedSymbols)this.expectedSymbols.hasOwnProperty(e)&&(t+=" "+this.expectedSymbols[e].name)}return t};var n=function(t,e){this.name=t,this.code=e};n.WARNING=new n("WARNING",0),n.ENCODING_ERROR=new n("ENCODING_ERROR",1),n.LEXICAL_ERROR=new n("LEXICAL_ERROR",2),n.SYNTAX_ERROR=new n("SYNTAX_ERROR",3),n.prototype.toString=function(){return this.name};var r=function(){};r.processFirstSets=function(t,e){var i,s,n,r=function(t,e){for(var i=!1,s=0;s<e.length;++s)t[e[s].index]||(i=!0),t[e[s].index]=e[s];return i},o=2;for(i=0;i<e.length;++i)if(e[i]instanceof l){o=i;break}var a=(e.length-o,{}),h=new N("EPSILON",e.length);for(i=0;i<e.length;++i)a[i]={};for(a[h.index]={},r(a[h.index],[h]),i=0;o>i;++i)r(a[i],[e[i]]);for(i=o;i<e.length;++i)for(s=0;s<t.length;++s)e[i].equals(t[s].head)&&t[s].isEpsilon()&&r(a[i],[h]);for(var c=!0;c;)for(c=!1,i=o;i<e.length;++i)for(s=0;s<t.length;++s)if(e[i].equals(t[s].head))for(n=0;n<t[s].tail.length&&(r(a[i],a[i])&&(c=!0),a[i][h.index]);++n);var u=function(t){return p[t]},d=Object.keys(a);for(i=0;i<d.length;++i){var p=a[d[i]];a[d[i]]=Object.keys(p).map(u)}return a};var o=function(t,e,i){this.index=t,this.head=e,this.tail=i};o.prototype.isEpsilon=function(){return 0===this.tail.length},o.prototype.toString=function(){for(var t=this.head.toString()+" ::= ",e=0;e<this.tail.length;++e)t+=this.tail[e].toString()+" ";return t},o.prototype.equals=function(t){if(t===this)return!0;if(!(t instanceof o))return!1;if(this.tail.length!==t.tail.length)return!1;for(var e=0;e<this.tail.length;++e)if(!this.tail[e].equals(t.tail[e]))return!1;return!this.head&&!t.head||this.head&&this.head.equals(t.head)};var a=function(t){if(t.length%2!==0)throw"InputStream: str must be even";this.str=t,this.i=0};a.prototype.read=function(){if(!this.hasNext())return-1;var t=parseInt(this.str.substring(this.i,this.i+2),16);return this.i=this.i+2,t-128},a.prototype.hasNext=function(){return this.i<this.str.length};var h=function(t,e){this.type=t,this.targetIndex="number"==typeof e?e:-1};h.prototype.toString=function(){return this.targetIndex>=0?this.type.toString()+" "+this.targetIndex:this.type.toString()};var c=function(t,e){this.name=t,this.code=e};c.NONE=new c("NONE",0),c.GOTO=new c("GOTO",1),c.SHIFT=new c("SHIFT",2),c.REDUCE=new c("REDUCE",3),c.ACCEPT=new c("ACCEPT",4),c.prototype.toInt=function(){return this.code},c.prototype.toString=function(){return this.name},c.get=function(t){var e=[c.NONE,c.GOTO,c.SHIFT,c.REDUCE,c.ACCEPT];return e[t]};var u=function(t){this.symbol=t.head,this.rule=t,this.children=[]};u.prototype.getPosition=function(){if(!this.children||!this.children.length){if(this.parent){var t=this.parent.children.indexOf(this);return t<this.parent.children.length-1?this.parent.children[t+1].getPosition():new p}return new p}return this.children[0].getPosition()},u.prototype.getLength=function(){if(!(this.children&&this.children.length&&this.getPosition()&&this.children[this.children.length-1].getPosition()))return 0;var t=this.children[this.children.length-1];return t.getPosition().index+t.getLength()-this.getPosition().index},u.prototype.addChildFirst=function(t){this.children.unshift(t),t.parent=this},u.prototype.addChildLast=function(t){this.children.push(t),t.parent=this},u.prototype.toString=function(){var t=this.getPosition();return this.rule.toString()+" ||  pos: "+t.index+" ("+t.line+","+t.col+"), len: "+this.getLength()},u.prototype.equals=function(t){if(t===this)return!0;if(!(t instanceof u))return!1;if(this.children.length!==t.children.length)return!1;for(var e=0;e<this.children.length;++e)if(!this.children[e].equals(t.children[e]))return!1;return!this.rule&&!t.rule||this.rule&&this.rule.equals(t.rule)},u.prototype.treeToString=function(t){t=t||0;var e=function(t){for(var e="",i=0;t>i;++i)e+=t-1>i?"| ":"|-";return e+="-"},i="\n"+e(t)+this.toString();if(this.children)for(var s=0;s<this.children.length;++s)i+=this.children[s]instanceof u?this.children[s].treeToString(t+1):"\n"+e(t+1)+this.children[s].toString();return i};var l=function(t,e){this.name=t,this.index=e};l.prototype.toString=function(){return"<"+this.name+">"},l.prototype.equals=function(t){return t===this?!0:t instanceof l?this.name===t.name:!1};var d=function(t,e,i,s,n){this.lrTable=t,this.ruleTable=e,this.symbolTable=i,this.startIndex=s,this.scanner=n,this.curNodeStack=[],this.stateStack=[],this.stateStack.push(R.EOS.code),this.name=n.name,this.reset()};d.READY=0,d.ACCEPT=1,d.ERROR=2,d.prototype.reset=function(){this.curNodeStack=[],this.stateStack=[],this.stateStack.push(R.EOS.code),this.error=null,this.scanner.reset(),this.tok=null},d.prototype.parse=function(t){if(t&&(this.reset(),this.scanner.setSource(t)),!this.scanner.source)throw"Parser: source not set";var e;do e=this.reduce();while(e===d.READY);return e===d.ACCEPT?this.curNodeStack[0]:null},d.prototype.getCurrentNode=function(){return this.curNodeStack?this.curNodeStack[this.curNodeStack.length-1]:null},d.prototype.reduce=function(){if(!this.scanner.source)throw"Parser: source not set";for(var t=this,e=function(){return t.stateStack[t.stateStack.length-1]},i=function(){for(var i=r.processFirstSets(t.ruleTable,t.symbolTable),o={},a=e(),h=0;h<t.lrTable[a].length;++h)if(t.lrTable[a][h]&&t.lrTable[a][h].type!==c.NONE)for(var u=i[t.symbolTable[h].index],l=0;l<u.length;++l)o[u[l].index]=u[l];var d=[];for(var p in o)o.hasOwnProperty(p)&&d.push(o[p]);return new s(n.SYNTAX_ERROR,t.tok,d)};;){if(null===this.tok&&(this.tok=this.scanner.scan()),this.tok.symbol.index===R.ERROR.code)return this.error=new s(n.LEXICAL_ERROR,this.tok),d.ERROR;var o=this.lrTable[e()][this.tok.symbol.index];if(!o)return this.error=i(),d.ERROR;switch(o.type){case c.SHIFT:this.stateStack.push(o.targetIndex),this.curNodeStack.push(this.tok),this.tok=null;break;case c.REDUCE:for(var a=this.ruleTable[o.targetIndex],h=0,l=new u(a),p=0;p<a.tail.length;++p)h=this.stateStack.pop(),l.addChildFirst(this.curNodeStack.pop());return this.curNodeStack.push(l),h=e(),this.stateStack.push(this.lrTable[h][a.head.index].targetIndex),d.READY;case c.GOTO:break;case c.ACCEPT:return d.ACCEPT;default:return this.error=i(),d.ERROR}}},d.prototype.getStartSymbol=function(){return this.symbolTable[this.startIndex]},d.prototype.getSource=function(){return this.scanner.source},d.prototype.setSource=function(t){this.scanner.setSource(t)};var p=function(t,e,i){this.line=t||0,this.col=e||0,this.index=i||0};p.prototype.equals=function(t){return t===this?!0:t instanceof p?this.line===t.line&&this.col===t.col&&this.index===t.index:!1},p.prototype.toString=function(t){return this.index+" ("+this.line+","+this.col+")"},p.prototype.clone=function(){return new p(this.line,this.col,this.index)};var f={BYTE_RECORD_SEPARATOR:30,BYTE_UNIT_SEPARATOR:31,BEGIN_INFO_SECTION:73,BEGIN_SCANNER_SECTION:83,BEGIN_CHARACTER_SET_SECTION:67,BEGIN_TERMINAL_SECTION:84,BEGIN_DFA_SECTION:68,BEGIN_SINGLE_DFA:68,BEGIN_DFA_STATE_SECTION:115,BEGIN_DFA_EDGE_SECTION:101,BEGIN_DFA_ACTION_SECTION:97,DFA_ACTION_IGNORE:105,DFA_ACTION_NEWLINE:110,DFA_ACTION_PUSHBACK:112,DFA_ACTION_BEGIN:115,DFA_ACTION_END:101,DFA_ACTION_GOTO:103,DFA_ACTION_INDENT:104,BEGIN_PARSER_SECTION:80,PARSER_TYPE_LR0:121,PARSER_TYPE_SLR:120,PARSER_TYPE_LR1:119,PARSER_TYPE_LALR1:118,PARSER_TYPE_LRED1:117,BEGIN_SYMBOL_SECTION:83,BEGIN_RULE_SECTION:82,BEGIN_TABLE_SECTION:84},T={MAJOR_VERSION:1,MINOR_VERSION:0,PATCH_VERSION:0,deserialize:function(t){var i=new e(t);return i.deserialize()}},S=function(t){this.source=t,this.cnt=0};S.prototype.read=function(){return this.source.charCodeAt(this.cnt++)},S.prototype.lastString=function(t){return this.source.substring(this.cnt-t,this.cnt)},S.prototype.unread=function(t){t=t||1,this.cnt-=t},S.prototype.reset=function(){this.cnt=0};var E=function(t){this.name=t,this.scanners={},this.arSymbolTable=[],this.currentScanner=null,this.initialScanner=null,this.source=null,this.firstIgnoredIndex=-1,this.reset()};E.INITIAL_LINE=1,E.INITIAL_COL=1,E.INITIAL_POS=0,E.prototype.reset=function(){this.curPos=new p(E.INITIAL_LINE,E.INITIAL_COL,E.INITIAL_POS),this.begPos=new p(E.INITIAL_LINE,E.INITIAL_COL,E.INITIAL_POS),this.scannerStack=[],this.source=null,this.currentScanner=this.initialScanner,this.indentBased&&(this.indenting=!0,this.level=0,this.levelStack=[],this.queue=[])},E.prototype.processLevel=function(){var t=this,e=function(){return t.levelStack[t.levelStack.length-1]};if(0===this.levelStack.length)this.levelStack.push(this.level);else if(e()<this.level)this.levelStack.push(this.level),this.queue.unshift(this.createBeginBlock());else if(e()>this.level){var i=this.levelStack.pop();for(this.queue.unshift(this.createEndBlock());this.levelStack.length&&e()>this.level&&(i=this.levelStack.pop(),this.queue.unshift(this.createEndBlock()),0!==this.queue.length););(0!==this.queue.length&&e()!==this.level||0===this.levelStack.length&&i!==this.level)&&this.queue.unshift(this.createErrorBlock())}},E.prototype.closePendingBlocks=function(){for(;this.levelStack.length>1;)this.levelStack.pop(),this.queue.unshift(this.createEndBlock())},E.prototype.createBeginBlock=function(){return new I(this.arSymbolTable[R.BEGIN.code])},E.prototype.createEndBlock=function(){return new I(this.arSymbolTable[R.END.code])},E.prototype.createErrorBlock=function(){return new I(this.arSymbolTable[R.ERROR.code])},E.prototype.scan=function(){var t=null;do if(this.indentBased){if(0===this.queue.length&&(t=this.currentScanner.scan()),0!==this.queue.length){var e=this.queue.splice(0,1)[0],i=this.currentScanner.getAction(e.symbol);if(i&&(i.end||i.start||i.gotoTarget)){if(i.end&&this.end(),i.start&&this.begin(i.start),i.gotoTarget&&(this.currentScanner=i.gotoTarget),t){for(var s=t.data,n=0;n<s.length;++n)this.source.unread(s.charCodeAt(n));this.tokenReset()}}else t&&this.queue.push(t);t=e}}else t=this.currentScanner.scan();while(!t);return t.pos=this.begPos.clone(),t},E.prototype.init=function(t,e,i){this.arSymbolTable=i,this.firstIgnoredIndex=this.arSymbolTable.length,this.scanners={};for(var s=0;s<t.length;++s)this.scanners[t[s].name]=t[s],t[s].parent=this;this.initialScanner=this.scanners[e],this.currentScanner=this.initialScanner},E.prototype.getSymbol=function(t){if("number"==typeof t)return this.arSymbolTable[t];for(var e=0;e<this.arSymbolTable.length;++e)if(this.arSymbolTable[e].name===t)return this.arSymbolTable[e];throw"'"+t+"' is not a symbol name"},E.prototype.begin=function(t){t&&(this.scannerStack.push(this.currentScanner),this.currentScanner=t)},E.prototype.end=function(){this.scannerStack.length&&(this.currentScanner=this.scannerStack.pop())},E.prototype.tokenBegin=function(){this.begPos=this.curPos.clone()},E.prototype.tokenReset=function(){this.curPos=this.begPos.clone()},E.prototype.newCol=function(t){this.curPos.col+=t,this.curPos.index+=t},E.prototype.setSource=function(t){this.reset(),this.source=new S(t)},E.prototype.getPublicSymbolTable=function(){return this.arSymbolTable.slice(0,this.firstIgnoredIndex)},E.prototype.getInternalSymbolTable=function(){return this.arSymbolTable};var R=function(t,e){this.name=t,this.code=e};R.EOS=new R("EOS",0),R.ERROR=new R("ERROR",1),R.BEGIN=new R("BEGIN",2),R.END=new R("END",3);var g=function(t){this.acceptedSymbol=t||null,this.edges=null};g.prototype.isFinal=function(){return!!this.acceptedSymbol};var _=function(t,e){this.name=t,this.initialState=e,this.parent=null,this.actions={},this.tokenLength=0};_.prototype.upsertAction=function(e){var i=this.actions[e.name];return i||(i=new t(e),this.actions[e.name]=i),i},_.prototype.getAction=function(t){return this.actions[t.name]||null},_.prototype.setAction=function(t){this.actions[t.symbol.name]=t},_.prototype.nextState=function(t,e){for(var i=0;i<t.edges.length;++i)if(t.edges[i].accepts(e))return t.edges[i].targetState;return null},_.prototype.scan=function(){if(!this.parent)throw"parent cannot be null";var t,e=null,i=0,s=this.initialState,n=this.parent.getSymbol(R.ERROR.code);this.indentBased&&(t=!1),this.parent.tokenBegin();var r=-1,o=this.parent.source.read();if(!o)return this.indentBased&&this.parent.closePendingBlocks(),e=new I(this.parent.getSymbol(R.EOS.code)),e.data="",e;for(;o;){++this.tokenLength;var a=this.nextState(s,o);if(!a)break;s=a,s.isFinal()&&(this.parent.newCol(this.tokenLength-i),i=this.tokenLength,n=s.acceptedSymbol),(10===o||13===o||12===o||11===o||133===o||8232===o||8233===o)&&((13!==r||10!==o)&&++this.parent.curPos.line,this.parent.curPos.col=E.INITIAL_COL,this.indentBased&&(this.parent.indenting=!0,t=!0)),r=o,o=this.parent.source.read()}var h=this.actions[n.name];if(this.indentBased&&this.parent.indenting&&(h&&h.indent?this.parent.level+=i:(t||(this.parent.processLevel(),this.parent.indenting=!1),this.parent.level=0)),h?(h.pushback&&(h.gotoTarget||h.start||h.end)?(this.parent.source.unread(this.tokenLength),this.tokenLength=0,this.parent.tokenReset(),e=null):e=new I(n),h.end&&this.parent.end(),h.start&&this.parent.begin(h.start),h.gotoTarget&&(this.parent.currentScanner=h.gotoTarget)):e=new I(n),e)if(n.index===R.ERROR.code)this.parent.source.unread(this.tokenLength),this.tokenLength=0,this.parent.tokenReset(),this.parent.newCol(1),e.data=String.fromCharCode(this.parent.source.read());else{var c=this.tokenLength-i;this.parent.source.unread(c),this.tokenLength-=c,e=new I(n),e.data=this.parent.source.lastString(this.tokenLength)}return this.tokenLength=0,h&&h.ignore?null:e};var I=function(t){this.symbol=t,this.data="",this.pos=new p};I.prototype.getPosition=function(){return this.pos},I.prototype.isEOS=function(){return this.symbol.index===R.EOS.code},I.prototype.isError=function(){return this.symbol.index===R.ERROR.code},I.prototype.getLength=function(){return this.data&&""!==this.data?this.data.length:0},I.prototype.toString=function(){return this.symbol.toString()+"["+this.data+"] pos: "+this.pos.index+" ("+this.pos.line+","+this.pos.col+"), len: "+this.getLength()},I.prototype.equals=function(t){return t===this?!0:t instanceof I?(!this.symbol&&!t.symbol||this.symbol&&this.symbol.equals(t.symbol))&&(!this.data&&!t.data||this.data&&this.data===t.data)&&(!this.pos&&!t.pos||this.pos&&this.pos.equals(t.pos)):!1};var N=function(t,e){this.name=t,this.index=e};return N.prototype.setDisplayName=function(t){this.display=t},N.prototype.getDisplayName=function(){return this.display?this.display:this.name},N.prototype.toString=function(){return this.name},N.prototype.equals=function(t){return t===this?!0:t instanceof N?this.name===t.name:!1},T.ErrorType=n,T}();